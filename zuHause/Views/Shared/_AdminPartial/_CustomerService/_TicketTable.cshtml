@{
    var isUnresolvedTab = ViewData["TabType"]?.ToString() == "unresolved";
    var tableTitle = isUnresolvedTab ? "未結案件列表" : "客服案件列表";
    var ticketCount = isUnresolvedTab ? "5" : "8";
}

<!-- 案件列表區 -->
<div class="@(isUnresolvedTab ? "" : "card")">
    @if (!isUnresolvedTab)
    {
        <div class="card-header d-flex justify-content-between align-items-center">
            <h5 class="mb-0">
                <i class="bi bi-list-task me-2"></i>@tableTitle
            </h5>
            <div class="d-flex align-items-center">
                <span class="badge bg-secondary me-2">共 @ticketCount 筆案件</span>
                <div class="btn-group btn-group-sm">
                    <button class="btn btn-outline-secondary" id="refreshBtn">重新整理列表
                        <i class="bi bi-arrow-clockwise"></i>
                    </button>
                </div>
            </div>
        </div>
    }
    <div class="card-body p-0">
        <div class="table-responsive">
            <table class="table table-striped table-hover mb-0">
                <thead class="table-dark">
                    <tr>
                        <th>客服單號</th>
                        <th>主旨</th>
                        <th>會員姓名</th>
                        <th>關聯項目</th>
                        <th>狀態</th>
                        <th>建立時間</th>
                        <th>更新時間</th>
                        <th>處理人員</th>
                        <th>操作</th>
                    </tr>
                </thead>
                <tbody>
                    @if (isUnresolvedTab)
                    {
                        <!-- 未結案件資料：只顯示待處理和處理中，按建立時間由舊到新排序 -->
                        <tr class="ticket-row" data-ticket-id="CS008">
                            <td class="fw-bold">CS008</td>
                            <td>傢俱退貨諮詢</td>
                            <td><a href="#" class="text-decoration-none">周小弟</a></td>
                            <td>
                                <span class="badge bg-warning text-dark">傢俱</span>
                                <a href="#" class="text-decoration-none ms-1">ORD-20240711-003</a>
                            </td>
                            <td><button class="btn btn-sm btn-info text-white">處理中</button></td>
                            <td>2024-07-12 10:20:00</td>
                            <td>2024-07-12 14:15:00</td>
                            <td>林管理員</td>
                            <td>
                                <button class="btn btn-sm btn-outline-primary" onclick="viewTicketDetails('CS008')">
                                    <i class="bi bi-eye me-1"></i>查看
                                </button>
                            </td>
                        </tr>
                        
                        <tr class="ticket-row" data-ticket-id="CS004">
                            <td class="fw-bold">CS004</td>
                            <td>傢俱配送問題</td>
                            <td><a href="#" class="text-decoration-none">劉先生</a></td>
                            <td>
                                <span class="badge bg-warning text-dark">傢俱</span>
                                <a href="#" class="text-decoration-none ms-1">ORD-20240710-005</a>
                            </td>
                            <td><button class="btn btn-sm btn-info text-white">處理中</button></td>
                            <td>2024-07-13 14:10:00</td>
                            <td>2024-07-13 16:30:00</td>
                            <td>王管理員</td>
                            <td>
                                <button class="btn btn-sm btn-outline-primary" onclick="viewTicketDetails('CS004')">
                                    <i class="bi bi-eye me-1"></i>查看
                                </button>
                            </td>
                        </tr>
                        
                        <tr class="ticket-row" data-ticket-id="CS007">
                            <td class="fw-bold">CS007</td>
                            <td>租約提前終止協商</td>
                            <td><a href="#" class="text-decoration-none">吳大哥</a></td>
                            <td>
                                <span class="badge bg-info text-white">租約</span>
                                <a href="#" class="text-decoration-none ms-1">C020</a>
                            </td>
                            <td><button class="btn btn-sm btn-warning text-dark">待處理</button></td>
                            <td>2024-07-14 11:20:00</td>
                            <td>2024-07-14 11:20:00</td>
                            <td>-</td>
                            <td>
                                <button class="btn btn-sm btn-outline-primary" onclick="viewTicketDetails('CS007')">
                                    <i class="bi bi-eye me-1"></i>查看
                                </button>
                            </td>
                        </tr>
                        
                        <tr class="ticket-row" data-ticket-id="CS002">
                            <td class="fw-bold">CS002</td>
                            <td>租約合約條款疑問</td>
                            <td><a href="#" class="text-decoration-none">李小華</a></td>
                            <td>
                                <span class="badge bg-info text-white">租約</span>
                                <a href="#" class="text-decoration-none ms-1">C008</a>
                            </td>
                            <td><button class="btn btn-sm btn-info text-white">處理中</button></td>
                            <td>2024-07-14 08:30:00</td>
                            <td>2024-07-14 10:45:00</td>
                            <td>張管理員</td>
                            <td>
                                <button class="btn btn-sm btn-outline-primary" onclick="viewTicketDetails('CS002')">
                                    <i class="bi bi-eye me-1"></i>查看
                                </button>
                            </td>
                        </tr>
                        
                        <tr class="ticket-row" data-ticket-id="CS005">
                            <td class="fw-bold">CS005</td>
                            <td>房源審核失敗原因詢問</td>
                            <td><a href="#" class="text-decoration-none">黃女士</a></td>
                            <td>
                                <span class="badge bg-success text-white">屋源</span>
                                <a href="#" class="text-decoration-none ms-1">P003</a>
                            </td>
                            <td><button class="btn btn-sm btn-warning text-dark">待處理</button></td>
                            <td>2024-07-14 16:30:00</td>
                            <td>2024-07-14 16:30:00</td>
                            <td>-</td>
                            <td>
                                <button class="btn btn-sm btn-outline-primary" onclick="viewTicketDetails('CS005')">
                                    <i class="bi bi-eye me-1"></i>查看
                                </button>
                            </td>
                        </tr>
                    }
                    else
                    {
                        <!-- 全部案件資料：按建立時間由新到舊排序 -->
                        <tr class="ticket-row" data-ticket-id="CS005">
                            <td class="fw-bold">CS005</td>
                            <td>房源審核失敗原因詢問</td>
                            <td><a href="#" class="text-decoration-none">黃女士</a></td>
                            <td>
                                <span class="badge bg-success text-white">屋源</span>
                                <a href="#" class="text-decoration-none ms-1">P003</a>
                            </td>
                            <td><button class="btn btn-sm btn-warning text-dark">待處理</button></td>
                            <td>2024-07-14 16:30:00</td>
                            <td>2024-07-14 16:30:00</td>
                            <td>-</td>
                            <td>
                                <button class="btn btn-sm btn-outline-primary" onclick="viewTicketDetails('CS005')">
                                    <i class="bi bi-eye me-1"></i>查看
                                </button>
                            </td>
                        </tr>
                        
                        <tr class="ticket-row" data-ticket-id="CS007">
                            <td class="fw-bold">CS007</td>
                            <td>租約提前終止協商</td>
                            <td><a href="#" class="text-decoration-none">吳大哥</a></td>
                            <td>
                                <span class="badge bg-info text-white">租約</span>
                                <a href="#" class="text-decoration-none ms-1">C020</a>
                            </td>
                            <td><button class="btn btn-sm btn-warning text-dark">待處理</button></td>
                            <td>2024-07-14 11:20:00</td>
                            <td>2024-07-14 11:20:00</td>
                            <td>-</td>
                            <td>
                                <button class="btn btn-sm btn-outline-primary" onclick="viewTicketDetails('CS007')">
                                    <i class="bi bi-eye me-1"></i>查看
                                </button>
                            </td>
                        </tr>
                        
                        <tr class="ticket-row" data-ticket-id="CS002">
                            <td class="fw-bold">CS002</td>
                            <td>租約合約條款疑問</td>
                            <td><a href="#" class="text-decoration-none">李小華</a></td>
                            <td>
                                <span class="badge bg-info text-white">租約</span>
                                <a href="#" class="text-decoration-none ms-1">C008</a>
                            </td>
                            <td><button class="btn btn-sm btn-info text-white">處理中</button></td>
                            <td>2024-07-14 08:30:00</td>
                            <td>2024-07-14 10:45:00</td>
                            <td>張管理員</td>
                            <td>
                                <button class="btn btn-sm btn-outline-primary" onclick="viewTicketDetails('CS002')">
                                    <i class="bi bi-eye me-1"></i>查看
                                </button>
                            </td>
                        </tr>
                        
                        <tr class="ticket-row" data-ticket-id="CS003">
                            <td class="fw-bold">CS003</td>
                            <td>房源審核不通過原因說明</td>
                            <td><a href="#" class="text-decoration-none">陳小美</a></td>
                            <td>
                                <span class="badge bg-success text-white">屋源</span>
                                <a href="#" class="text-decoration-none ms-1">P001</a>
                            </td>
                            <td><button class="btn btn-sm btn-success text-white">已回覆</button></td>
                            <td>2024-07-13 16:20:00</td>
                            <td>2024-07-14 11:00:00</td>
                            <td>林管理員</td>
                            <td>
                                <button class="btn btn-sm btn-outline-primary" onclick="viewTicketDetails('CS003')">
                                    <i class="bi bi-eye me-1"></i>查看
                                </button>
                            </td>
                        </tr>
                        
                        <tr class="ticket-row" data-ticket-id="CS004">
                            <td class="fw-bold">CS004</td>
                            <td>傢俱配送問題</td>
                            <td><a href="#" class="text-decoration-none">劉先生</a></td>
                            <td>
                                <span class="badge bg-warning text-dark">傢俱</span>
                                <a href="#" class="text-decoration-none ms-1">ORD-20240710-005</a>
                            </td>
                            <td><button class="btn btn-sm btn-info text-white">處理中</button></td>
                            <td>2024-07-13 14:10:00</td>
                            <td>2024-07-13 16:30:00</td>
                            <td>王管理員</td>
                            <td>
                                <button class="btn btn-sm btn-outline-primary" onclick="viewTicketDetails('CS004')">
                                    <i class="bi bi-eye me-1"></i>查看
                                </button>
                            </td>
                        </tr>
                        
                        <tr class="ticket-row" data-ticket-id="CS006">
                            <td class="fw-bold">CS006</td>
                            <td>合約解約流程諮詢</td>
                            <td><a href="#" class="text-decoration-none">趙小姐</a></td>
                            <td>
                                <span class="badge bg-info text-white">租約</span>
                                <a href="#" class="text-decoration-none ms-1">C015</a>
                            </td>
                            <td><button class="btn btn-sm btn-success text-white">已回覆</button></td>
                            <td>2024-07-12 20:15:00</td>
                            <td>2024-07-13 09:30:00</td>
                            <td>張管理員</td>
                            <td>
                                <button class="btn btn-sm btn-outline-primary" onclick="viewTicketDetails('CS006')">
                                    <i class="bi bi-eye me-1"></i>查看
                                </button>
                            </td>
                        </tr>
                        
                        <tr class="ticket-row" data-ticket-id="CS008">
                            <td class="fw-bold">CS008</td>
                            <td>傢俱退貨諮詢</td>
                            <td><a href="#" class="text-decoration-none">周小弟</a></td>
                            <td>
                                <span class="badge bg-warning text-dark">傢俱</span>
                                <a href="#" class="text-decoration-none ms-1">ORD-20240711-003</a>
                            </td>
                            <td><button class="btn btn-sm btn-info text-white">處理中</button></td>
                            <td>2024-07-12 10:20:00</td>
                            <td>2024-07-12 14:15:00</td>
                            <td>林管理員</td>
                            <td>
                                <button class="btn btn-sm btn-outline-primary" onclick="viewTicketDetails('CS008')">
                                    <i class="bi bi-eye me-1"></i>查看
                                </button>
                            </td>
                        </tr>
                        
                        <tr class="ticket-row" data-ticket-id="CS001">
                            <td class="fw-bold">CS001</td>
                            <td>房源審核意見反應</td>
                            <td><a href="#" class="text-decoration-none">張先生</a></td>
                            <td>
                                <span class="badge bg-success text-white">屋源</span>
                                <a href="#" class="text-decoration-none ms-1">P002</a>
                            </td>
                            <td><button class="btn btn-sm btn-success text-white">已回覆</button></td>
                            <td>2024-07-11 15:45:00</td>
                            <td>2024-07-12 09:15:00</td>
                            <td>王管理員</td>
                            <td>
                                <button class="btn btn-sm btn-outline-primary" onclick="viewTicketDetails('CS001')">
                                    <i class="bi bi-eye me-1"></i>查看
                                </button>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
    
    <!-- 分頁區 -->
    <div class="card-footer">
        <nav aria-label="客服案件分頁">
            <ul class="pagination pagination-sm justify-content-center mb-0">
                <li class="page-item disabled">
                    <span class="page-link">上一頁</span>
                </li>
                <li class="page-item active">
                    <span class="page-link">1</span>
                </li>
                <li class="page-item">
                    <a class="page-link" href="#">2</a>
                </li>
                <li class="page-item">
                    <a class="page-link" href="#">下一頁</a>
                </li>
            </ul>
        </nav>
    </div>
</div>