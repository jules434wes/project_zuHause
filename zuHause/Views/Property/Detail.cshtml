@using zuHause.ViewModels
@model PropertyDetailViewModel
@{
    ViewData["Title"] = Model.Title;
    Layout = null; // ‰ΩøÁî®Ëá™ÂÆöÁæ©‰ΩàÂ±Ä
}

<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"]</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <!-- Variables CSS -->
    <link rel="stylesheet" href="~/css/variables.css" />
    <!-- Property Detail CSS -->
    <link rel="stylesheet" href="~/css/property-detail.css" />
    <!-- Google Maps Integration CSS -->
    <link rel="stylesheet" href="~/css/google-maps-style.css" />
    
    <style>
        /* ÂúñÁâáÊ®°ÊÖãÊ°ÜÊ®£Âºè */
        #modalImage {
            transition: opacity 0.25s ease;
            max-height: 80vh;
            object-fit: contain;
        }
        
        /* ‰∏ªÂúñÂçÄÂüüÊ®£Âºè */
        .main-image-container {
            position: relative;
            overflow: hidden;
            border-radius: 0.5rem;
        }
        
        .main-image {
            width: 100%;
            height: auto;
            display: block;
        }
        
        /* ÂúñÁâáÂÆπÂô®Ê®£Âºè */
        .modal-image-container {
            position: relative;
            width: 100%;
            height: 70vh;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        
        /* Ê∑°ÂÖ•Ê∑°Âá∫ÊïàÊûú */
        .fade-in {
            animation: fadeIn 0.25s ease forwards;
        }
        
        .fade-out {
            animation: fadeOut 0.25s ease forwards;
        }
        
        @@keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @@keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }
        
        .modal-prev, .modal-next {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            z-index: 1050;
            background-color: rgba(255, 255, 255, 0.8);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            border: none;
        }
        
        .modal-prev:hover, .modal-next:hover {
            background-color: rgba(255, 255, 255, 1);
            transform: scale(1.15);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
        }
        
        .modal-prev i, .modal-next i {
            font-size: 1.25rem;
            color: #333;
        }
        
        #modalImageCounter {
            font-size: 0.9rem;
            padding: 5px 10px;
            border-radius: 15px;
        }
        
        @@media (max-width: 576px) {
            .modal-prev, .modal-next {
                width: 40px;
                height: 40px;
            }
            
            .modal-prev i, .modal-next i {
                font-size: 1rem;
            }
            
            .modal-image-container {
                height: 50vh;
            }
        }
    </style>

        <link rel="stylesheet" href="~/css/_LoginPartialShared.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/zuHause.styles.css" asp-append-version="true" />
</head>
<body>
    <div class="min-vh-100 bg-light position-relative">
        <!-- ‰∏ªÂ∞éË¶ΩÂàó -->
            @await Component.InvokeAsync("NavbarMember")

        <!-- ÂÅµÊ∏¨ÈªûÂÖÉÁ¥† - Áî®ÊñºËß∏ÁôºÊ¨°Â∞éË¶ΩÂàóÈ°ØÁ§∫ -->
        <div class="sentinel-element" id="sentinelElement"></div>

        <!-- Ê¨°Ë¶ÅÂ∞éË¶ΩÂàó - ÊªæÂãïËß∏Áôº -->
        <nav class="quick-navigation-tabs" id="quickNavigationTabs">
            <div class="container-fluid px-4">
                <ul class="nav nav-tabs" role="tablist" aria-label="ÊàøÊ∫êË©≥Á¥∞Ë≥áË®äÂ∞éË¶Ω">
                    <li class="nav-item" role="presentation">
                        <a class="nav-link active" 
                           id="house-info-tab" 
                           href="#house-info" 
                           role="tab" 
                           aria-controls="house-info" 
                           aria-selected="true"
                           data-section="house-info">
                            ÊàøÂ±ãË≥áË®ä
                        </a>
                    </li>
                    <li class="nav-item" role="presentation">
                        <a class="nav-link" 
                           id="costs-rules-tab" 
                           href="#costs-rules" 
                           role="tab" 
                           aria-controls="costs-rules" 
                           aria-selected="false"
                           data-section="costs-rules">
                            Ë≤ªÁî®ÂèäÂÆàÂâá
                        </a>
                    </li>
                    <li class="nav-item" role="presentation">
                        <a class="nav-link" 
                           id="amenities-tab" 
                           href="#amenities" 
                           role="tab" 
                           aria-controls="amenities" 
                           aria-selected="false"
                           data-section="amenities">
                            Ë®≠ÂÇôËàáÊúçÂãô
                        </a>
                    </li>
                    <li class="nav-item" role="presentation">
                        <a class="nav-link" 
                           id="description-tab" 
                           href="#description" 
                           role="tab" 
                           aria-controls="description" 
                           aria-selected="false"
                           data-section="description">
                            ÊèèËø∞
                        </a>
                    </li>
                    <li class="nav-item" role="presentation">
                        <a class="nav-link" 
                           id="transportation-tab" 
                           href="#transportation" 
                           role="tab" 
                           aria-controls="transportation" 
                           aria-selected="false"
                           data-section="transportation">
                            ‰ΩçÁΩÆ
                        </a>
                    </li>
                </ul>
            </div>
        </nav>

        <!-- ‰∏ªË¶ÅÂÖßÂÆπÂçÄÂüü -->
        <div class="container-fluid px-4 py-4">
            <div class="row">
                <!-- Â∑¶ÂÅ¥‰∏ªË¶ÅÂÖßÂÆπ -->
                <div class="col-lg-8">
                    <!-- ÊàøÂ±ãÊ®ôÈ°åÂíåÊìç‰ΩúÊåâÈàï -->
                    <div class="property-header mb-4">
                        <div class="d-flex align-items-start justify-content-between mb-3">
                            <h1 class="property-title">@Model.Title</h1>
                            <div class="property-actions d-flex gap-2">
                                <button class="action-btn-v2" id="shareBtn">
                                    <i class="fas fa-share me-1"></i>
                                    ÂàÜ‰∫´
                                </button>
                                <button class="action-btn-v2 @(Model.IsFavorite ? "active" : "")" id="favoriteBtn" data-property-id="@Model.PropertyId">
                                    <i class="@(Model.IsFavorite ? "fas" : "far") fa-heart me-1"></i>
                                    @(Model.IsFavorite ? "Â∑≤Êî∂Ëóè" : "Êî∂Ëóè")
                                </button>
                                <div class="dropdown">
                                    <button class="action-btn-v2" data-bs-toggle="dropdown">
                                        <i class="fas fa-ellipsis-v"></i>
                                    </button>
                                    <ul class="dropdown-menu">
                                        <li><a class="dropdown-item" href="#" id="reportBtn">
                                            <i class="fas fa-flag me-2"></i>ÂõûÂ†±Ê≠§ÊàøÊ∫êÂïèÈ°å
                                        </a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ÂúñÁâáÂ±ïÁ§∫ÂçÄÂüü -->
                    <div class="property-gallery mb-4">
                        @if (Model.Images.Any())
                        {
                            <!-- ‰∏ªÂúñÁâá -->
                            <div class="main-image-container position-relative mb-3">
                                <img src="@Model.Images.FirstOrDefault()?.ImagePath" 
                                     alt="@Model.Images.FirstOrDefault()?.Category" 
                                     class="main-image w-100 rounded-3 fade-in" 
                                     id="mainImage" 
                                     data-bs-toggle="modal" 
                                     data-bs-target="#imageModal">
                                <div class="image-overlay position-absolute top-0 start-0 p-3">
                                    <span class="image-label bg-dark bg-opacity-50 text-white px-2 py-1 rounded small">
                                        @(Model.Images.FirstOrDefault()?.Category ?? "ÊàøÂ≠êÁ∏ΩË¶ΩÂúñ")
                                    </span>
                                </div>
                                <!-- Â∑¶Âè≥ÂàáÊèõÊåâÈàï -->
                                <button class="modal-prev gallery-prev position-absolute top-50 start-0 translate-middle-y ms-3" style="width:45px; height:45px"><i class="fas fa-chevron-left"></i></button>
                                <button class="modal-next gallery-next position-absolute top-50 end-0 translate-middle-y me-3" style="width:45px; height:45px"><i class="fas fa-chevron-right"></i></button>
                            </div>

                            <!-- Á∏ÆÂúñ -->
                            @if (Model.Images.Count > 1)
                            {
                                <div class="d-flex align-items-center">
                                    <button class="modal-prev thumb-prev me-2" style="width:32px; height:32px; min-width:32px"><i class="fas fa-chevron-left" style="font-size:0.8rem"></i></button>
                                    <div class="row g-2 flex-nowrap overflow-auto thumbnails-wrapper" style="scroll-behavior:smooth;">
                                        @foreach (var image in Model.Images.Skip(1))
                                        {
                                            <div class="col-3 flex-shrink-0">
                                                <div class="thumbnail-container position-relative">
                                                    <img src="@image.ImagePath" 
                                                         alt="@image.Category" 
                                                         class="thumbnail-image w-100 rounded-2" 
                                                         data-image-src="@image.ImagePath">
                                                    <div class="thumbnail-overlay position-absolute bottom-0 start-0 p-1">
                                                        <span class="thumbnail-label bg-dark bg-opacity-70 text-white px-1 rounded small" style="font-size: 0.7rem;">
                                                            @(image.Category ?? "ÊàøÊ∫êÂúñÁâá")
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                        }
                                    </div>
                                    <button class="modal-next thumb-next ms-2" style="width:32px; height:32px; min-width:32px"><i class="fas fa-chevron-right" style="font-size:0.8rem"></i></button>
                                </div>
                            }
                        }
                    </div>

                    <!-- ÊàøÂ±ãË≥áË®ä -->
                    <section id="house-info" class="detail-section mb-4">
                        <h2 class="section-header">
                            <i class="fas fa-home me-2"></i>
                            ÊàøÂ±ãË≥áË®ä
                        </h2>
                        <div class="section-content">
                            <!-- Âü∫Êú¨Ë≥áË®äÂúñÊ®ôÂàó -->
                            <div class="d-flex flex-wrap gap-4 mb-4 text-muted">
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-map-marker-alt me-1"></i>
                                    @Model.DistrictName, @Model.CityName
                                </div>
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-bed me-1"></i>
                                    @(Model.HouseInfo.Rooms ?? "Êú™Êèê‰æõ")
                                </div>
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-bath me-1"></i>
                                    @(Model.HouseInfo.Bathrooms ?? "Êú™Êèê‰æõ")
                                </div>
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-users me-1"></i>
                                    1-2‰∫∫
                                </div>
                            </div>

                            <!-- Ë©≥Á¥∞Ë≥áË®ä -->
                            <div class="row g-4">
                                <div class="col-md-6">
                                    <div class="info-grid">
                                        <div class="info-item">
                                            <span class="info-label">ÊàøÂ±ãÈ°ûÂûãÔºö</span>
                                            <span class="info-value">@(Model.HouseInfo.PropertyType ?? "Êú™Êèê‰æõ")</span>
                                        </div>
                                        <div class="info-item">
                                            <span class="info-label">Ê®ìÂ±§Ôºö</span>
                                            <span class="info-value">@(Model.HouseInfo.Floor ?? "Êú™Êèê‰æõ")</span>
                                        </div>
                                        <div class="info-item">
                                            <span class="info-label">Âù™Êï∏Ôºö</span>
                                            <span class="info-value">@(Model.HouseInfo.Area ?? "Êú™Êèê‰æõ")</span>
                                        </div>
                                        <div class="info-item">
                                            <span class="info-label">ÊúùÂêëÔºö</span>
                                            <span class="info-value">ÂçóÂêë</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="info-grid">
                                        <div class="info-item">
                                            <span class="info-label">Â±ãÈΩ°Ôºö</span>
                                            <span class="info-value">@(Model.HouseInfo.Age > 0 ? Model.HouseInfo.Age + "Âπ¥" : "Êú™Êèê‰æõ")</span>
                                        </div>
                                        <div class="info-item">
                                            <span class="info-label">ÈõªÊ¢ØÔºö</span>
                                            <span class="info-value">Êúâ</span>
                                        </div>
                                        <div class="info-item">
                                            <span class="info-label">ÂÅúËªä‰ΩçÔºö</span>
                                            <span class="info-value">@(Model.HouseInfo.Parking ?? "Êú™Êèê‰æõ")</span>
                                        </div>
                                        <div class="info-item">
                                            <span class="info-label">ÂØµÁâ©Ôºö</span>
                                            <span class="info-value">@(Model.RulesAndFees.AllowPets ? "ÂèØÈ§ä" : "‰∏çÂèØÈ§ä")</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Ë≤ªÁî®ÂèäÂÆàÂâá -->
                    <section id="costs-rules" class="detail-section mb-4">
                        <h2 class="section-header">
                            <i class="fas fa-file-contract me-2"></i>
                            Ë≤ªÁî®
                        </h2>
                        <div class="section-content">
                            <div class="row g-4">
                                <div class="col-md-6">
                                    <h4 class="h6 text-muted mb-3">ÈôÑÂä†Ë≤ªÁî®</h4>
                                    <div class="cost-items">
                                        <div class="cost-item">
                                            <div class="d-flex align-items-center">
                                                <span class="cost-label">ÈõªË≤ª</span>
                                                <i class="fas fa-info-circle ms-1 text-muted small"></i>
                                            </div>
                                            <div class="cost-value small text-muted">ÊØèÂ∫¶ NT$ 6/Êúà</div>
                                        </div>
                                        <div class="cost-item">
                                            <div class="d-flex align-items-center">
                                                <span class="cost-label">Ê∞¥Ë≤ª</span>
                                                <i class="fas fa-info-circle ms-1 text-muted small"></i>
                                            </div>
                                            <div class="cost-value small text-muted">NT$ @Model.RulesAndFees.UtilityDeposit.ToString("N0")/Êúà</div>
                                        </div>
                                        <div class="cost-item">
                                            <div class="d-flex align-items-center">
                                                <span class="cost-label">ÂÅúËªäË≤ª</span>
                                                <i class="fas fa-info-circle ms-1 text-muted small"></i>
                                            </div>
                                            <div class="cost-value small text-muted">ÊØèËªä‰Ωç NT$ 2,000/Êúà</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <h4 class="h6 text-muted mb-3">‰∏ÄÊ¨°ÊÄßË≤ªÁî®</h4>
                                    <div class="cost-items">
                                        <div class="cost-item">
                                            <span class="cost-label">ÊäºÈáë</span>
                                            <div class="cost-value fw-medium text-danger">NT$ @Model.RulesAndFees.Deposit.ToString("N0")</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Ë®≠ÂÇôËàáÊúçÂãô -->
                    <section id="amenities" class="detail-section mb-4">
                        <h2 class="section-header">
                            <i class="fas fa-cogs me-2"></i>
                            Ë®≠ÂÇôËàáÊúçÂãô
                        </h2>
                        <div class="section-content">
                            @if (Model.Equipment.Any())
                            {
                                var groupedEquipment = Model.Equipment.GroupBy(e => e.EquipmentType).ToList();
                                
                                <!-- Âª∫Áâ©Ë®≠ÊñΩ -->
                                <div class="amenity-category mb-4">
                                    <h3 class="amenity-title">Âª∫Áâ©Ë®≠ÊñΩ</h3>
                                    <div class="row g-2">
                                        <div class="col-md-4 amenity-item">Ê∏∏Ê≥≥Ê±†</div>
                                        <div class="col-md-4 amenity-item">ÂÅ•Ë∫´Êàø</div>
                                        <div class="col-md-4 amenity-item">ÊúÉË≠∞ÂÆ§</div>
                                        <div class="col-md-4 amenity-item">KTV</div>
                                    </div>
                                </div>
                                <hr class="amenity-divider">

                                <!-- Áâ©Ê•≠ÊúçÂãô -->
                                <div class="amenity-category mb-4">
                                    <h3 class="amenity-title">Áâ©Ê•≠ÊúçÂãô</h3>
                                    <div class="row g-2">
                                        <div class="col-md-4 amenity-item">Êî∂ÁôºÂåÖË£π</div>
                                        <div class="col-md-4 amenity-item">24Â∞èÊôÇÁÆ°ÁêÜ</div>
                                        <div class="col-md-4 amenity-item">ÂûÉÂúæÂ≠êÊØçËªä</div>
                                    </div>
                                </div>
                                <hr class="amenity-divider">

                                <!-- ÂÆ§ÂÖßË®≠ÂÇô -->
                                @foreach (var category in groupedEquipment.Where(g => g.Key != "ÂÖ∂‰ªñ"))
                                {
                                    <div class="amenity-category mb-4">
                                        <h3 class="amenity-title">@category.Key</h3>
                                        <div class="row g-2">
                                            @foreach (var equipment in category)
                                            {
                                                <div class="col-md-4 amenity-item">@equipment.EquipmentName</div>
                                            }
                                        </div>
                                    </div>
                                    <hr class="amenity-divider">
                                }

                                <!-- ÂÖ∂‰ªñ -->
                                var otherCategory = groupedEquipment.FirstOrDefault(g => g.Key == "ÂÖ∂‰ªñ");
                                @if (otherCategory != null)
                                {
                                    <div class="amenity-category">
                                        <h3 class="amenity-title">ÂÖ∂‰ªñ</h3>
                                        <div class="row g-4">
                                            <div class="col-md-6">
                                                <div class="other-group">
                                                    <div class="fw-semibold text-muted mb-2">ÂØµÁâ©</div>
                                                    <div class="ms-3">
                                                        <div class="fw-medium">Ë≤ìÂí™</div>
                                                        <div class="ms-3 amenity-item">@(Model.RulesAndFees.AllowPets ? "ÂÖÅË®±" : "‰∏çÂÖÅË®±")</div>
                                                        <div class="fw-medium mt-2">Áãó</div>
                                                        <div class="ms-3 amenity-item">‰∏çÂÖÅË®±</div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="other-group">
                                                    <div class="fw-semibold text-muted mb-2">Á•ûÊòéÂª≥</div>
                                                    <div class="ms-3 amenity-item">‰∏çÂÖÅË®±</div>
                                                </div>
                                                <div class="other-group mt-3">
                                                    <div class="fw-semibold text-muted mb-2">ÁßüÂ±ãË£úÂä©</div>
                                                    <div class="ms-3 amenity-item">ÂèØÁî≥Ë´ã</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                }
                            }
                        </div>
                    </section>

                    <!-- ÊàøÂ±ãÊèèËø∞ -->
                    <section id="description" class="detail-section mb-4">
                        <h2 class="section-header">
                            <i class="fas fa-info-circle me-2"></i>
                            ÊàøÂ±ãÊèèËø∞
                        </h2>
                        <div class="section-content">
                            <p class="lh-relaxed text-muted">
                                @if (!string.IsNullOrEmpty(Model.Description))
                                {
                                    @Html.Raw(Model.Description.Replace("\n", "<br>"))
                                }
                                else
                                {
                                    @:ÊàøÊù±Â∞öÊú™Êèê‰æõË©≥Á¥∞ÊèèËø∞
                                }
                            </p>
                        </div>
                    </section>

                    <!-- ‰∫§ÈÄöË≥áË®ä -->
                    <section id="transportation" class="detail-section mb-4">
                        <h2 class="section-header">
                            <i class="fas fa-map-marker-alt me-2"></i>
                            ‰∫§ÈÄöË≥áË®ä
                        </h2>
                        <div class="section-content">
                            <div class="transport-info">
                                <div class="transport-item">
                                    <span class="transport-label">Êç∑ÈÅãÂ∏ÇÊîøÂ∫úÁ´ôÔºö</span>
                                    <span class="transport-value">Ê≠•Ë°å5ÂàÜÈêò</span>
                                </div>
                                <div class="transport-item">
                                    <span class="transport-label">ÂÖ¨ËªäÁ´ôÔºö</span>
                                    <span class="transport-value">Ê≠•Ë°å2ÂàÜÈêò</span>
                                </div>
                                <div class="transport-item">
                                    <span class="transport-label">Âè∞Âåó101Ôºö</span>
                                    <span class="transport-value">Ê≠•Ë°å8ÂàÜÈêò</span>
                                </div>
                                <div class="transport-item">
                                    <span class="transport-label">‰ø°Áæ©ÂïÜÂúàÔºö</span>
                                    <span class="transport-value">Ê≠•Ë°å10ÂàÜÈêò</span>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>

                <!-- Âè≥ÂÅ¥Ë≥áË®äÈù¢Êùø -->
                <div class="col-lg-4">
                    <div class="property-info-sidebar" id="propertySidebar">
                        <!-- ÂÉπÊ†ºË≥áË®äÂç°Áâá -->
                        <div class="info-card" id="price-info">
                            <div class="price-display text-center mb-3">
                                <div class="price-label small text-muted mb-1">Ê®ôÈ°å</div>
                                <div class="price-amount">NT$ @Model.Price.ToString("N0")/Êúà</div>
                            </div>

                            <div class="property-quick-info">
                                <div class="quick-info-item">
                                    <i class="fas fa-map-marker-alt me-2 text-muted"></i>
                                    Âú∞ÂùÄÔºö@Model.Address
                                </div>

                                <div class="row g-2 mt-3">
                                    <div class="col-6">
                                        <div class="quick-detail">
                                            <span class="quick-label">ÊäºÈáë:</span>
                                            <span class="quick-value">ÊäºÂÖ©ÂÄãÊúà</span>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="quick-detail">
                                            <span class="quick-label">Âù™Êï∏:</span>
                                            <span class="quick-value">@(Model.HouseInfo.Area ?? "Êú™Êèê‰æõ")</span>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="quick-detail">
                                            <span class="quick-label">È°ûÂûã:</span>
                                            <span class="quick-value">@(Model.HouseInfo.PropertyType ?? "Êú™Êèê‰æõ")</span>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="quick-detail">
                                            <span class="quick-label">Ê†ºÂ±Ä:</span>
                                            <span class="quick-value">@(Model.HouseInfo.Rooms ?? "Êú™Êèê‰æõ")</span>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="quick-detail">
                                            <span class="quick-label">Ëªä‰Ωç:</span>
                                            <span class="quick-value">@(Model.HouseInfo.Parking ?? "ÁÑ°")</span>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="quick-detail">
                                            <span class="quick-label">Ê®ìÂ±§:</span>
                                            <span class="quick-value">@(Model.HouseInfo.Floor ?? "Êú™Êèê‰æõ")</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- ÊàøÊù±Ë≥áË®äÂíåÊìç‰ΩúÊåâÈàïÂç°Áâá -->
                        <div class="info-card">
                            <!-- ÊàøÊù±Ë≥áË®ä -->
                            <div class="landlord-info mb-4">
                                <div class="d-flex align-items-center mb-3">
                                    <div class="landlord-avatar bg-light rounded-circle d-flex align-items-center justify-content-center me-3">
                                        <i class="fas fa-user text-muted"></i>
                                    </div>
                                    <div>
                                        <div class="landlord-label small text-muted">ÊàøÊù±</div>
                                        <div class="landlord-name fw-medium">@Model.LandlordName</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Á´ãÂç≥Áî≥ÁßüÊåâÈàï (ÁâπÊÆäÊ®£Âºè) -->
                            <div class="mb-3">
                                <button class="btn-apply-rent w-100">
                                    üî• Á´ãÂç≥Áî≥Áßü
                                </button>
                            </div>

                            <!-- ÂÖ∂‰ªñÊìç‰ΩúÊåâÈàï -->
                            <div class="action-buttons">
                                <button class="btn-schedule-visit w-100 mb-2">
                                    <i class="fas fa-calendar me-2"></i>
                                    È†êÁ¥ÑÁúãÊàø
                                </button>
                                <button class="btn-contact w-100" data-bs-toggle="modal" data-bs-target="#contactModal">
                                    <i class="fas fa-envelope me-2"></i>
                                    Á´ãÂç≥ËÅØÁµ°
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ÂúñÁâáÊîæÂ§ßÊ®°ÊÖãÊ°Ü -->
    <div class="modal fade" id="imageModal" tabindex="-1">
        <div class="modal-dialog modal-xl modal-dialog-centered">
            <div class="modal-content bg-transparent border-0">
                <div class="modal-header border-0 bg-transparent">
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-0 position-relative">
                    <div class="modal-image-container">
                        <img src="" alt="" class="rounded fade-in" id="modalImage">
                    </div>
                    <!-- Â∑¶Âè≥ÂàáÊèõÊåâÈàï -->
                    <button type="button" id="modalPrevBtn" class="modal-prev modal-control position-absolute top-50 start-0 translate-middle-y ms-4">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <button type="button" id="modalNextBtn" class="modal-next modal-control position-absolute top-50 end-0 translate-middle-y me-4">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
                <div class="modal-footer border-0 bg-transparent justify-content-center">
                    <span class="text-white bg-dark bg-opacity-50 px-3 py-1 rounded small" id="modalImageCounter"></span>
                </div>
            </div>
        </div>
    </div>

    <!-- ËÅØÁµ°ÊàøÊù±Ê®°ÊÖãÊ°Ü -->
    <div class="modal fade" id="contactModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">ËÅØÁµ°ÊàøÊù±</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="mb-3">
                            <label class="form-label">ÂßìÂêç *</label>
                            <input type="text" class="form-control" placeholder="Ë´ãËº∏ÂÖ•ÊÇ®ÁöÑÂßìÂêç">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">ËÅØÁµ°ÈõªË©± *</label>
                            <input type="tel" class="form-control" placeholder="Ë´ãËº∏ÂÖ•ÊÇ®ÁöÑÈõªË©±ËôüÁ¢º">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">ÈõªÂ≠êÈÉµ‰ª∂ *</label>
                            <input type="email" class="form-control" placeholder="Ë´ãËº∏ÂÖ•ÊÇ®ÁöÑÈõªÂ≠êÈÉµ‰ª∂">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">LINE Â∏≥Ëôü</label>
                            <input type="text" class="form-control" placeholder="Ë´ãËº∏ÂÖ•ÊÇ®ÁöÑ LINE ID">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">ÂÇôË®ªÂíåË™™Êòé</label>
                            <textarea class="form-control" rows="3" placeholder="Ë´ãËº∏ÂÖ•ÂÖ∂‰ªñÊÉ≥Ë™™ÊòéÁöÑ‰∫ãÈ†Ö..."></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ÂèñÊ∂à</button>
                    <button type="button" class="btn btn-primary">Êèê‰∫§</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Property Detail JS -->
    <script src="~/js/property-detail.js"></script>
    <!-- Google Maps Integration JS -->
    <script src="~/js/google-maps-integration.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            try {
                const mapManager = new PropertyMapManager();
                mapManager.initMap(@Model.PropertyId);
            } catch (e) {
                console.warn('Âú∞ÂúñÂàùÂßãÂåñËÖ≥Êú¨ÈåØË™§', e);
            }
        });
    </script>
</body>
</html>